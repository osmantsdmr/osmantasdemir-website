---
import Layout from '../layouts/Layout.astro';
import Navbar from '../components/Navbar.astro';
import { getCollection } from 'astro:content';

const projeler = await getCollection('projeler');

// √ñnce √∂ne √ßƒ±kanlar, sonra diƒüerleri (tarihe g√∂re yeniden eskiye)
const siraliProjeler = projeler.sort((a, b) => {
  if (a.data.oneCikan && !b.data.oneCikan) return -1;
  if (!a.data.oneCikan && b.data.oneCikan) return 1;
  return (b.data.tarih || '').localeCompare(a.data.tarih || '');
});

// Kategorileri topla (filtreleme i√ßin)
const kategoriler = [...new Set(projeler.map(p => p.data.kategori))];
---

<Layout title="Projeler | Osman Ta≈üdemir">
  <Navbar />
  
  <main>
    <!-- Hero Section -->
    <section class="hero-section">
      <div class="hero-bg-effects">
        <div class="hero-glow hero-glow-1"></div>
        <div class="hero-glow hero-glow-2"></div>
        <div class="particle particle-1"></div>
        <div class="particle particle-2"></div>
        <div class="particle particle-3"></div>
        <div class="particle particle-4"></div>
      </div>
      
      <div class="hero-content animate-fade-in">
        <span class="hero-badge">Portf√∂y</span>
        <h1>Projelerim</h1>
        <p>CBS, uzaktan algƒ±lama ve otomasyon alanlarƒ±nda ger√ßekle≈ütirdiƒüim projeler.</p>
        
        <!-- Proje ƒ∞statistikleri -->
        <div class="stats-row">
          <div class="stat-item">
            <span class="stat-number">{siraliProjeler.length}</span>
            <span class="stat-label">Proje</span>
          </div>
          <div class="stat-divider"></div>
          <div class="stat-item">
            <span class="stat-number">{siraliProjeler.filter(p => p.data.oneCikan).length}</span>
            <span class="stat-label">√ñne √áƒ±kan</span>
          </div>
          <div class="stat-divider"></div>
          <div class="stat-item">
            <span class="stat-number">{kategoriler.length}</span>
            <span class="stat-label">Kategori</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Filter & Projects Section -->
    <section class="projects-section">
      <div class="section-transition-top"></div>
      <div class="container">
        
        <!-- Kategori Filtreleri -->
        {kategoriler.length > 1 && (
          <div class="filter-bar scroll-animate">
            <button class="filter-btn active" data-filter="all">
              T√ºm√º
            </button>
            {kategoriler.map((kategori) => (
              <button class="filter-btn" data-filter={kategori}>
                {kategori}
              </button>
            ))}
          </div>
        )}
        
        {siraliProjeler.length === 0 ? (
          <div class="empty-state scroll-animate">
            <span class="empty-icon">üìÅ</span>
            <p>Hen√ºz proje eklenmemi≈ü.</p>
          </div>
        ) : (
          <div class="projects-grid">
            {siraliProjeler.map((proje, index) => (
              <a 
                href={`/projeler/${proje.slug}`} 
                class="project-card scroll-animate"
                data-category={proje.data.kategori}
                style={`transition-delay: ${(index % 6) * 100}ms;`}
              >
                <article class={proje.data.oneCikan ? 'featured' : ''}>
                  
                  {/* √ñne √áƒ±kan Badge */}
                  {proje.data.oneCikan && (
                    <div class="featured-badge">
                      <span class="star">‚≠ê</span> √ñne √áƒ±kan
                    </div>
                  )}
                  
                  {/* Proje G√∂rseli */}
                  <div class="project-image">
                    {proje.data.kapakGorseli ? (
                      <img 
                        src={proje.data.kapakGorseli} 
                        alt={proje.data.baslik}
                        loading="lazy"
                      />
                    ) : (
                      <div class="image-placeholder">
                        <span class="placeholder-icon">üó∫Ô∏è</span>
                        <span class="placeholder-text">Proje G√∂rseli</span>
                      </div>
                    )}
                    <div class="image-overlay"></div>
                  </div>
                  
                  {/* Proje Bilgileri */}
                  <div class="project-content">
                    <span class="category-badge">{proje.data.kategori}</span>
                    <h3>{proje.data.baslik}</h3>
                    <p>{proje.data.aciklama}</p>
                    
                    {/* Teknolojiler */}
                    <div class="tech-tags">
                      {proje.data.teknolojiler?.slice(0, 4).map((tech) => (
                        <span class="tech-tag">{tech}</span>
                      ))}
                      {proje.data.teknolojiler?.length > 4 && (
                        <span class="tech-tag more">+{proje.data.teknolojiler.length - 4}</span>
                      )}
                    </div>
                    
                    {/* G√∂r√ºnt√ºle Butonu */}
                    <div class="view-project">
                      <span>Projeyi ƒ∞ncele</span>
                      <svg class="arrow-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                      </svg>
                    </div>
                  </div>
                  
                </article>
              </a>
            ))}
          </div>
        )}
        
      </div>
    </section>

    <!-- CTA Section -->
    <section class="cta-section">
      <div class="section-transition-top from-projects"></div>
      <div class="cta-content scroll-animate">
        <h2>Birlikte √áalƒ±≈üalƒ±m</h2>
        <p>Sizin i√ßin de benzersiz bir proje geli≈ütirmemi ister misiniz?</p>
        <a href="/iletisim" class="cta-button">ƒ∞leti≈üime Ge√ß</a>
      </div>
    </section>

  </main>
</Layout>

<style>
  /* Hero Section */
  .hero-section {
    padding: 160px 20px 80px;
    background: linear-gradient(135deg, #37353E 0%, #1a1a1a 100%);
    position: relative;
    overflow: hidden;
    text-align: center;
  }

  .hero-bg-effects {
    position: absolute;
    inset: 0;
    pointer-events: none;
  }

  .hero-glow {
    position: absolute;
    border-radius: 50%;
    filter: blur(80px);
    opacity: 0.15;
  }

  .hero-glow-1 {
    width: 500px;
    height: 500px;
    background: #57564F;
    top: -200px;
    left: 10%;
    animation: pulse-glow 8s ease-in-out infinite;
  }

  .hero-glow-2 {
    width: 400px;
    height: 400px;
    background: #44444E;
    bottom: -150px;
    right: 5%;
    animation: pulse-glow 8s ease-in-out 4s infinite;
  }

  @keyframes pulse-glow {
    0%, 100% { opacity: 0.15; transform: scale(1); }
    50% { opacity: 0.25; transform: scale(1.1); }
  }

  .particle {
    position: absolute;
    width: 6px;
    height: 6px;
    background: #57564F;
    border-radius: 50%;
    opacity: 0.4;
  }

  .particle-1 { top: 20%; left: 15%; animation: float 15s ease-in-out infinite; }
  .particle-2 { top: 60%; right: 20%; animation: float 18s ease-in-out infinite reverse; }
  .particle-3 { bottom: 30%; left: 40%; animation: float 12s ease-in-out infinite; }
  .particle-4 { top: 40%; right: 35%; animation: float 20s ease-in-out infinite reverse; }

  @keyframes float {
    0%, 100% { transform: translateY(0) translateX(0); }
    25% { transform: translateY(-20px) translateX(10px); }
    50% { transform: translateY(-10px) translateX(-10px); }
    75% { transform: translateY(-30px) translateX(5px); }
  }

  .hero-content {
    position: relative;
    z-index: 1;
    max-width: 700px;
    margin: 0 auto;
  }

  .hero-badge {
    display: inline-block;
    background: rgba(87, 86, 79, 0.5);
    color: #D3DAD9;
    padding: 8px 20px;
    border-radius: 30px;
    font-size: 14px;
    letter-spacing: 2px;
    text-transform: uppercase;
    margin-bottom: 20px;
    border: 1px solid rgba(211, 218, 217, 0.1);
  }

  .hero-content h1 {
    font-size: 52px;
    font-weight: bold;
    color: #D3DAD9;
    margin-bottom: 16px;
  }

  .hero-content > p {
    font-size: 18px;
    color: #D3DAD9;
    opacity: 0.8;
    line-height: 1.7;
    margin-bottom: 40px;
  }

  /* Stats Row */
  .stats-row {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 30px;
    flex-wrap: wrap;
  }

  .stat-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
  }

  .stat-number {
    font-size: 36px;
    font-weight: bold;
    color: #D3DAD9;
  }

  .stat-label {
    font-size: 14px;
    color: #D3DAD9;
    opacity: 0.6;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .stat-divider {
    width: 1px;
    height: 40px;
    background: rgba(211, 218, 217, 0.2);
  }

  /* Section Transitions */
  .section-transition-top {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 100px;
    background: linear-gradient(to bottom, #37353E 0%, transparent 100%);
    pointer-events: none;
  }

  .section-transition-top.from-projects {
    background: linear-gradient(to bottom, #44444E 0%, transparent 100%);
  }

  /* Container */
  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
  }

  /* Projects Section */
  .projects-section {
    padding: 80px 0 100px;
    background-color: #44444E;
    position: relative;
  }

  /* Filter Bar */
  .filter-bar {
    display: flex;
    justify-content: center;
    gap: 12px;
    margin-bottom: 50px;
    flex-wrap: wrap;
  }

  .filter-btn {
    background: #37353E;
    color: #D3DAD9;
    border: 2px solid transparent;
    padding: 10px 24px;
    border-radius: 30px;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .filter-btn:hover {
    background: #57564F;
    transform: translateY(-2px);
  }

  .filter-btn.active {
    background: #57564F;
    border-color: #D3DAD9;
  }

  /* Empty State */
  .empty-state {
    text-align: center;
    padding: 80px 20px;
  }

  .empty-icon {
    font-size: 64px;
    display: block;
    margin-bottom: 20px;
    opacity: 0.5;
  }

  .empty-state p {
    color: #D3DAD9;
    opacity: 0.7;
    font-size: 18px;
  }

  /* Projects Grid */
  .projects-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(360px, 1fr));
    gap: 30px;
  }

  /* Project Card */
  .project-card {
    text-decoration: none;
    display: block;
  }

  .project-card article {
    background: #37353E;
    border-radius: 16px;
    overflow: hidden;
    transition: all 0.4s ease;
    position: relative;
    height: 100%;
    display: flex;
    flex-direction: column;
  }

  .project-card article:hover {
    transform: translateY(-10px);
    box-shadow: 0 25px 50px rgba(0,0,0,0.3);
  }

  .project-card article.featured {
    border: 2px solid rgba(212, 175, 55, 0.3);
  }

  .project-card article.featured:hover {
    border-color: rgba(212, 175, 55, 0.6);
    box-shadow: 0 25px 50px rgba(212, 175, 55, 0.1);
  }

  /* Featured Badge */
  .featured-badge {
    position: absolute;
    top: 16px;
    right: 16px;
    background: linear-gradient(135deg, #D4AF37 0%, #F2D06B 100%);
    color: #1a1a1a;
    padding: 8px 14px;
    border-radius: 25px;
    font-size: 12px;
    font-weight: bold;
    z-index: 10;
    display: flex;
    align-items: center;
    gap: 6px;
    box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
  }

  .featured-badge .star {
    font-size: 12px;
  }

  /* Project Image */
  .project-image {
    position: relative;
    height: 220px;
    overflow: hidden;
  }

  .project-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.5s ease;
  }

  .project-card article:hover .project-image img {
    transform: scale(1.08);
  }

  .image-overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(to top, rgba(55, 53, 62, 0.8) 0%, transparent 50%);
    opacity: 0;
    transition: opacity 0.4s ease;
  }

  .project-card article:hover .image-overlay {
    opacity: 1;
  }

  .image-placeholder {
    height: 100%;
    background: linear-gradient(135deg, #57564F 0%, #37353E 100%);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 10px;
  }

  .placeholder-icon {
    font-size: 48px;
    opacity: 0.4;
  }

  .placeholder-text {
    color: #D3DAD9;
    opacity: 0.4;
    font-size: 14px;
  }

  /* Project Content */
  .project-content {
    padding: 24px;
    flex: 1;
    display: flex;
    flex-direction: column;
  }

  .category-badge {
    display: inline-block;
    background: #57564F;
    color: #D3DAD9;
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 12px;
    margin-bottom: 14px;
    align-self: flex-start;
    transition: all 0.3s ease;
  }

  .project-card article:hover .category-badge {
    background: #6a695f;
  }

  .project-content h3 {
    font-size: 22px;
    font-weight: bold;
    color: #D3DAD9;
    margin-bottom: 10px;
    transition: color 0.3s ease;
  }

  .project-card article:hover .project-content h3 {
    color: #fff;
  }

  .project-content p {
    font-size: 14px;
    color: #D3DAD9;
    opacity: 0.7;
    line-height: 1.7;
    margin-bottom: 18px;
    flex: 1;
  }

  /* Tech Tags */
  .tech-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-bottom: 18px;
  }

  .tech-tag {
    background: #44444E;
    color: #D3DAD9;
    padding: 5px 12px;
    border-radius: 6px;
    font-size: 12px;
    transition: all 0.3s ease;
  }

  .tech-tag:hover {
    background: #57564F;
  }

  .tech-tag.more {
    background: transparent;
    border: 1px dashed #57564F;
    opacity: 0.7;
  }

  /* View Project Button */
  .view-project {
    display: flex;
    align-items: center;
    gap: 8px;
    color: #D3DAD9;
    font-size: 14px;
    font-weight: 500;
    opacity: 0.7;
    transition: all 0.3s ease;
    margin-top: auto;
  }

  .project-card article:hover .view-project {
    opacity: 1;
    color: #D4AF37;
  }

  .arrow-icon {
    width: 20px;
    height: 20px;
    transition: transform 0.3s ease;
  }

  .project-card article:hover .arrow-icon {
    transform: translateX(5px);
  }

  /* CTA Section */
  .cta-section {
    padding: 100px 20px;
    background: linear-gradient(135deg, #37353E 0%, #1a1a1a 100%);
    text-align: center;
    position: relative;
  }

  .cta-content {
    position: relative;
    z-index: 1;
    max-width: 600px;
    margin: 0 auto;
  }

  .cta-section h2 {
    font-size: 36px;
    font-weight: bold;
    color: #D3DAD9;
    margin-bottom: 15px;
  }

  .cta-section p {
    color: #D3DAD9;
    opacity: 0.7;
    font-size: 17px;
    margin-bottom: 35px;
  }

  .cta-button {
    display: inline-block;
    background: #57564F;
    color: #D3DAD9;
    padding: 16px 45px;
    border-radius: 8px;
    text-decoration: none;
    font-weight: 500;
    font-size: 16px;
    transition: all 0.3s ease;
  }

  .cta-button:hover {
    background: #6a695f;
    transform: translateY(-3px);
    box-shadow: 0 15px 40px rgba(87, 86, 79, 0.3);
  }

  /* Animations */
  .animate-fade-in {
    animation: fadeIn 1s ease-out forwards;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* Scroll Animations */
  .scroll-animate {
    opacity: 0;
    transform: translateY(40px);
    transition: opacity 0.6s ease-out, transform 0.6s ease-out;
  }

  .scroll-animate.visible {
    opacity: 1;
    transform: translateY(0);
  }

  /* Filter Animation */
  .project-card.hidden {
    display: none;
  }

  .project-card.fade-out {
    opacity: 0;
    transform: scale(0.95);
  }

  /* Responsive */
  @media (max-width: 768px) {
    .hero-content h1 {
      font-size: 36px;
    }

    .stats-row {
      gap: 20px;
    }

    .stat-number {
      font-size: 28px;
    }

    .stat-divider {
      height: 30px;
    }

    .projects-grid {
      grid-template-columns: 1fr;
    }

    .filter-bar {
      gap: 8px;
    }

    .filter-btn {
      padding: 8px 16px;
      font-size: 13px;
    }
  }
</style>

<script>
  // Scroll Animation with Intersection Observer
  const observerOptions = {
    root: null,
    rootMargin: '0px',
    threshold: 0.1
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
      }
    });
  }, observerOptions);

  document.addEventListener('DOMContentLoaded', () => {
    const animatedElements = document.querySelectorAll('.scroll-animate');
    animatedElements.forEach(el => observer.observe(el));

    // Filter Functionality
    const filterButtons = document.querySelectorAll('.filter-btn');
    const projectCards = document.querySelectorAll('.project-card');

    filterButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        // Update active button
        filterButtons.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');

        const filter = btn.getAttribute('data-filter');

        // Filter cards
        projectCards.forEach(card => {
          const category = card.getAttribute('data-category');
          
          if (filter === 'all' || category === filter) {
            card.classList.remove('hidden');
            card.classList.remove('fade-out');
            // Re-trigger animation
            setTimeout(() => {
              card.classList.add('visible');
            }, 50);
          } else {
            card.classList.add('fade-out');
            setTimeout(() => {
              card.classList.add('hidden');
            }, 300);
          }
        });
      });
    });
  });

  // Smooth scroll for anchor links
  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
      e.preventDefault();
      const target = document.querySelector(this.getAttribute('href'));
      if (target) {
        target.scrollIntoView({
          behavior: 'smooth',
          block: 'start'
        });
      }
    });
  });
</script>