---
import Layout from '../layouts/Layout.astro';
import Navbar from '../components/Navbar.astro';
import { getCollection } from 'astro:content';

const projeler = await getCollection('projeler');

// Önce öne çıkanlar, sonra diğerleri (tarihe göre yeniden eskiye)
const siraliProjeler = projeler.sort((a, b) => {
  // Önce öne çıkan durumuna göre sırala
  if (a.data.oneCikan && !b.data.oneCikan) return -1;
  if (!a.data.oneCikan && b.data.oneCikan) return 1;
  // Aynı öne çıkan durumunda tarihe göre sırala (yeniden eskiye)
  return (b.data.tarih || '').localeCompare(a.data.tarih || '');
});
---

<Layout title="Projeler | Osman Taşdemir">
  <Navbar />
  
  <main>
    <!-- Hero Section -->
    <section style="padding: 140px 20px 60px; background: linear-gradient(135deg, #37353E 0%, #1a1a1a 100%); text-align: center;">
      <h1 style="font-size: 42px; font-weight: bold; color: #D3DAD9; margin-bottom: 16px;">Projelerim</h1>
      <p style="font-size: 18px; color: #D3DAD9; opacity: 0.8; max-width: 600px; margin: 0 auto;">
        CBS, uzaktan algılama ve otomasyon alanlarında gerçekleştirdiğim projeler.
      </p>
    </section>

    <!-- Projects Grid -->
    <section style="padding: 60px 20px; background-color: #44444E;">
      <div style="max-width: 1200px; margin: 0 auto;">
        
        {siraliProjeler.length === 0 ? (
          <p style="text-align: center; color: #D3DAD9; opacity: 0.7;">Henüz proje eklenmemiş.</p>
        ) : (
          <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 30px;">
            {siraliProjeler.map((proje) => (
              <a href={`/projeler/${proje.slug}`} style="text-decoration: none;">
                <article style="background: #37353E; border-radius: 12px; overflow: hidden; transition: transform 0.3s, box-shadow 0.3s; cursor: pointer; position: relative;">
                  
                  {/* Öne Çıkan Yıldız */}
                  {proje.data.oneCikan && (
                    <div style="position: absolute; top: 12px; right: 12px; background: #D4AF37; color: #1a1a1a; padding: 6px 10px; border-radius: 20px; font-size: 12px; font-weight: bold; z-index: 10; display: flex; align-items: center; gap: 4px;">
                      <span>⭐</span> Öne Çıkan
                    </div>
                  )}
                  
                  {proje.data.kapakGorseli ? (
                    <img 
                      src={proje.data.kapakGorseli} 
                      alt={proje.data.baslik}
                      style="width: 100%; height: 200px; object-fit: cover;"
                    />
                  ) : (
                    <div style="height: 200px; background: linear-gradient(135deg, #57564F 0%, #37353E 100%); display: flex; align-items: center; justify-content: center;">
                      <span style="color: #D3DAD9; opacity: 0.5; font-size: 14px;">Proje Görseli</span>
                    </div>
                  )}
                  <div style="padding: 24px;">
                    <span style="display: inline-block; background: #57564F; color: #D3DAD9; padding: 4px 12px; border-radius: 20px; font-size: 12px; margin-bottom: 12px;">
                      {proje.data.kategori}
                    </span>
                    <h3 style="font-size: 20px; font-weight: bold; color: #D3DAD9; margin-bottom: 8px;">{proje.data.baslik}</h3>
                    <p style="font-size: 14px; color: #D3DAD9; opacity: 0.7; margin-bottom: 16px; line-height: 1.6;">
                      {proje.data.aciklama}
                    </p>
                    <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                      {proje.data.teknolojiler?.slice(0, 3).map((tech) => (
                        <span style="background: #44444E; color: #D3DAD9; padding: 4px 10px; border-radius: 6px; font-size: 12px;">
                          {tech}
                        </span>
                      ))}
                    </div>
                  </div>
                </article>
              </a>
            ))}
          </div>
        )}
        
      </div>
    </section>
  </main>
</Layout>

<style>
  article:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 40px rgba(0,0,0,0.3);
  }
</style>